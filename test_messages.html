<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶ˆæ¯æ°”æ³¡æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .info-btn { background: #2196f3; color: white; }
        .success-btn { background: #4caf50; color: white; }
        .warning-btn { background: #ff9800; color: white; }
        .error-btn { background: #f44336; color: white; }
        .rapid-btn { background: #9c27b0; color: white; }
        
        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #1976d2;
        }
        
        .instructions ul {
            margin-bottom: 0;
        }
        
        .instructions li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>æ¶ˆæ¯æ°”æ³¡æ’åˆ—æµ‹è¯•</h1>
        
        <div class="instructions">
            <h3>æµ‹è¯•è¯´æ˜ï¼š</h3>
            <ul>
                <li>ç‚¹å‡»ä¸åŒç±»å‹çš„æ¶ˆæ¯æŒ‰é’®ï¼Œè§‚å¯Ÿæ¶ˆæ¯æ°”æ³¡çš„æ’åˆ—æ•ˆæœ</li>
                <li>æ–°æ¶ˆæ¯åº”è¯¥ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ’åˆ—ï¼Œè€Œä¸æ˜¯é‡å è¦†ç›–</li>
                <li>æ¶ˆæ¯æ¶ˆå¤±æ—¶ï¼Œå‰©ä½™æ¶ˆæ¯åº”è¯¥é‡æ–°æ’åˆ—</li>
                <li>ä½¿ç”¨"å¿«é€Ÿå‘é€å¤šæ¡æ¶ˆæ¯"æµ‹è¯•è¿ç»­æ¶ˆæ¯çš„æ’åˆ—æ•ˆæœ</li>
            </ul>
        </div>
        
        <div class="test-buttons">
            <button class="info-btn" onclick="testMessage('info')">å‘é€ä¿¡æ¯æ¶ˆæ¯</button>
            <button class="success-btn" onclick="testMessage('success')">å‘é€æˆåŠŸæ¶ˆæ¯</button>
            <button class="warning-btn" onclick="testMessage('warning')">å‘é€è­¦å‘Šæ¶ˆæ¯</button>
            <button class="error-btn" onclick="testMessage('error')">å‘é€é”™è¯¯æ¶ˆæ¯</button>
            <button class="rapid-btn" onclick="sendMultipleMessages()">å¿«é€Ÿå‘é€å¤šæ¡æ¶ˆæ¯</button>
        </div>
        
        <div id="status">
            <h3>æµ‹è¯•çŠ¶æ€</h3>
            <p>å·²å‘é€æ¶ˆæ¯æ•°é‡ï¼š<span id="message-count">0</span></p>
            <p>æœ€åå‘é€æ—¶é—´ï¼š<span id="last-time">æœªå‘é€</span></p>
        </div>
    </div>

    <!-- å¤åˆ¶dom-utils.jsçš„ä»£ç  -->
    <script src="src/renderer/utils/dom-utils.js"></script>
    <script>
        let messageCount = 0;
        
        // ç”±äºä¸èƒ½ç›´æ¥requireï¼Œæˆ‘ä»¬å¤åˆ¶ç›¸å…³çš„å‡½æ•°
        const colors = {
            error: '#f44336',
            success: '#4caf50',
            warning: '#ff9800',
            info: '#2196f3'
        };
        
        function createMessageElement(message, type, duration = 5000) {
            const messageDiv = document.createElement('div');
            
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                background: ${colors[type] || colors.info};
                color: white;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 10000;
                font-size: 14px;
                max-width: 400px;
                word-wrap: break-word;
                opacity: 0;
                transform: translateX(100%);
                transition: opacity 0.3s ease, transform 0.3s ease;
                margin-bottom: 10px;
            `;
            
            messageDiv.textContent = message;
            
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            requestAnimationFrame(() => {
                messageDiv.style.opacity = '1';
                messageDiv.style.transform = 'translateX(0)';
            });
            
            return messageDiv;
        }
        
        function rearrangeMessages() {
            const existingMessages = document.querySelectorAll('div[style*="position: fixed"][style*="right: 20px"]');
            let totalHeight = 20; // åˆå§‹é¡¶éƒ¨è·ç¦»
            
            existingMessages.forEach(msg => {
                if (msg.parentNode) {
                    msg.style.top = `${totalHeight}px`;
                    totalHeight += msg.offsetHeight + 10; // åŠ ä¸Šæ¶ˆæ¯çš„é«˜åº¦å’Œé—´è·
                }
            });
        }
        
        function showMessage(message, type = 'info', duration = 5000) {
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            const messageDiv = createMessageElement(message, type, duration);
            
            // è®¡ç®—æ–°æ¶ˆæ¯çš„ä½ç½® - ä»ä¸Šåˆ°ä¸‹æ’åˆ—
            const existingMessages = document.querySelectorAll('div[style*="position: fixed"][style*="right: 20px"]');
            let totalHeight = 20; // åˆå§‹é¡¶éƒ¨è·ç¦»
            
            existingMessages.forEach(msg => {
                if (msg.parentNode && msg !== messageDiv) {
                    totalHeight += msg.offsetHeight + 10; // åŠ ä¸Šå·²æœ‰æ¶ˆæ¯çš„é«˜åº¦å’Œé—´è·
                }
            });
            
            // è®¾ç½®æ–°æ¶ˆæ¯çš„ä½ç½®
            messageDiv.style.top = `${totalHeight}px`;
            
            document.body.appendChild(messageDiv);
            
            // æ›´æ–°è®¡æ•°
            messageCount++;
            document.getElementById('message-count').textContent = messageCount;
            document.getElementById('last-time').textContent = new Date().toLocaleTimeString();
            
            // è‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                messageDiv.style.opacity = '0';
                messageDiv.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.parentNode.removeChild(messageDiv);
                    }
                    // é‡æ–°æ’åˆ—å‰©ä½™çš„æ¶ˆæ¯
                    rearrangeMessages();
                }, 300);
            }, duration);
        }
        
        function testMessage(type) {
            const messages = {
                info: 'è¿™æ˜¯ä¸€æ¡ä¿¡æ¯æ¶ˆæ¯ï¼Œç”¨äºæµ‹è¯•æ¶ˆæ¯æ°”æ³¡çš„æ’åˆ—æ•ˆæœ',
                success: 'æ“ä½œæˆåŠŸå®Œæˆï¼æ¶ˆæ¯æ°”æ³¡ç°åœ¨ä¼šä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ’åˆ—',
                warning: 'âš ï¸ è­¦å‘Šï¼šè¿™æ˜¯ä¸€æ¡è­¦å‘Šæ¶ˆæ¯ï¼Œè¯·æ³¨æ„æŸ¥çœ‹æ’åˆ—æ•ˆæœ',
                error: 'âŒ é”™è¯¯ï¼šå‘ç”Ÿäº†ä¸€ä¸ªé”™è¯¯ï¼Œæ¶ˆæ¯æ°”æ³¡æ’åˆ—æ­£å¸¸'
            };
            
            showMessage(messages[type], type, 5000);
        }
        
        function sendMultipleMessages() {
            const testMessages = [
                { text: 'ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼šæµ‹è¯•å¼€å§‹', type: 'info' },
                { text: 'ç¬¬äºŒæ¡æ¶ˆæ¯ï¼šæ–°æ¶ˆæ¯åº”è¯¥æ’åœ¨ä¸‹é¢', type: 'success' },
                { text: 'ç¬¬ä¸‰æ¡æ¶ˆæ¯ï¼šç»§ç»­å‘ä¸‹æ’åˆ—', type: 'warning' },
                { text: 'ç¬¬å››æ¡æ¶ˆæ¯ï¼šæœ€åä¸€æ¡æµ‹è¯•æ¶ˆæ¯', type: 'error' }
            ];
            
            testMessages.forEach((msg, index) => {
                setTimeout(() => {
                    showMessage(msg.text, msg.type, 6000);
                }, index * 800); // æ¯800æ¯«ç§’å‘é€ä¸€æ¡æ¶ˆæ¯
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„æ¬¢è¿æ¶ˆæ¯
        window.addEventListener('load', () => {
            setTimeout(() => {
                showMessage('ğŸ‰ æ¶ˆæ¯æ°”æ³¡æ’åˆ—æµ‹è¯•é¡µé¢å·²åŠ è½½å®Œæˆï¼ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•', 'success', 6000);
            }, 1000);
        });
    </script>
</body>
</html>