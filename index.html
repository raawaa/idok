<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>åª’ä½“èµ„æ–™åº“</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- è‡ªå®šä¹‰æ ‡é¢˜æ  -->
    <div id="custom-titlebar">
        <div id="app-title">ç”µå½±ç®¡ç†å™¨</div>
        <div class="theme-toggle-container">
            <span class="theme-toggle-label" title="åˆ‡æ¢äº®è‰²/æš—è‰²ä¸»é¢˜">ä¸»é¢˜</span>
            <label class="theme-toggle-btn" title="åˆ‡æ¢äº®è‰²/æš—è‰²ä¸»é¢˜">
                <input type="checkbox" id="theme-toggle">
                <span class="theme-toggle-slider"></span>
            </label>
        </div>
        <div id="window-controls">
            <button id="minimize-btn" class="window-control-btn">-</button>
            <button id="maximize-btn" class="window-control-btn">â–¡</button>
            <button id="close-btn" class="window-control-btn">Ã—</button>
        </div>
    </div>

    <!-- æ·»åŠ æ–°çš„å†…å®¹å®¹å™¨ -->
    <div id="content-container">
        <!-- é”™è¯¯æç¤ºå®¹å™¨ -->
        <div id="message-container"></div>
        
        <div id="controls">
            <!-- æœç´¢æ¡† -->
            <div class="search-container">
                <input type="text" id="search-input" placeholder="æœç´¢ç‰‡åæˆ–ç•ªå·..." autocomplete="off">
                <button id="clear-search-btn" class="clear-search-btn" title="æ¸…é™¤æœç´¢">âœ•</button>
            </div>

            <label for="sort-by">æ’åºæ–¹å¼:</label>
            <select id="sort-by">
                <option value="title">ç‰‡å</option>
                <option value="releaseDate">å‘å¸ƒæ—¥æœŸ</option>
            </select>

            <label for="sort-order">é¡ºåº:</label>
            <select id="sort-order">
                <option value="asc">å‡åº</option>
                <option value="desc">é™åº</option>
            </select>

            <label for="filter-actor">æ¼”å‘˜:</label>
            <select id="filter-actor">
                <option value="">å…¨éƒ¨æ¼”å‘˜</option>
            </select>

            <label for="filter-studio">ç‰‡å•†:</label>
            <select id="filter-studio">
                <option value="">å…¨éƒ¨ç‰‡å•†</option>
            </select>

            <label for="filter-genre">ç±»åˆ«:</label>
            <select id="filter-genre">
                <option value="">å…¨éƒ¨ç±»åˆ«</option>
            </select>

            <!-- æ¸…é™¤è¿‡æ»¤æŒ‰é’® -->
            <button id="clear-filters">æ¸…é™¤è¿‡æ»¤</button>

            <!-- è®¾ç½®æŒ‰é’® -->
            <button id="open-settings-btn">è®¾ç½®</button>

            <!-- å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šè¿‡æ»¤é€‰é¡¹ -->
        </div>

        <!-- è¿™é‡Œå°†æ˜¾ç¤ºç”µå½±å°é¢ -->
        <div id="movie-covers">

        </div>

        <!-- æ¨¡æ€æ¡†ç»“æ„ -->
        <div id="delete-modal">
            <div>
                <h2>ç¡®è®¤åˆ é™¤</h2>
                <p>æ‚¨ç¡®å®šè¦åˆ é™¤ä»¥ä¸‹å½±ç‰‡ç›®å½•è‡³å›æ”¶ç«™å—ï¼Ÿ</p>
                <p id="delete-path"></p>
                <div>
                    <button id="confirm-delete-btn">ç¡®è®¤</button>
                    <button id="cancel-delete-btn">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
        
        <!-- å½±ç‰‡è¯¦ç»†ä¿¡æ¯æ¨¡æ€æ¡†ç»“æ„ -->
        <div id="movie-details-modal" class="modal-overlay">
            <div class="modal-content">
                <h2 id="movie-details-title"></h2>
                <div class="movie-details-content">
                    <div class="detail-row">
                        <span class="detail-label">å‘å¸ƒæ—¥æœŸ:</span>
                        <span class="detail-value" id="movie-details-date"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ç‰‡å•†:</span>
                        <span class="detail-value" id="movie-details-studio"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">æ¼”å‘˜:</span>
                        <span class="detail-value" id="movie-details-actors"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">å¯¼æ¼”:</span>
                        <span class="detail-value" id="movie-details-directors"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ç±»åˆ«:</span>
                        <span class="detail-value" id="movie-details-genres"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">è§†é¢‘è·¯å¾„:</span>
                        <span class="detail-value" id="movie-details-path"></span>
                    </div>
                </div>
                <div class="modal-actions">
                    <button id="close-details-btn" class="btn btn-secondary">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>
    <!-- ç»“æŸå†…å®¹å®¹å™¨ -->
    </div>

    <!-- è®¾ç½®æ¨¡æ€æ¡†ç»“æ„ -->
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>è®¾ç½®</h2>
            <div id="settings-content">
                <!-- ç›®å½•è®¾ç½®æ¨¡æ¿ -->
                <div id="directory-settings-template" class="settings-section">
            <h3 class="settings-heading">åª’ä½“åº“ç›®å½•</h3>
            <div id="directory-list" class="directory-list">
                <!-- ç›®å½•é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
            </div>
            <button id="add-directory-btn" class="btn add-directory-btn">æ·»åŠ ç›®å½•</button>
        </div>
        
                <!-- æ’­æ”¾å™¨è®¾ç½®æ¨¡æ¿ -->
                <div id="player-settings-template" class="settings-section">
            <h3 class="settings-heading">é»˜è®¤æ’­æ”¾å™¨</h3>
            <div class="player-setting-container">
                <label for="default-player-select" class="setting-label">é€‰æ‹©é»˜è®¤æ’­æ”¾å™¨:</label>
                <div class="player-select-container">
                    <select id="default-player-select" class="player-select">
                        <option value="">ç³»ç»Ÿé»˜è®¤æ’­æ”¾å™¨</option>
                        <!-- å¯ç”¨æ’­æ”¾å™¨é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </select>
                    <button id="custom-player-btn" class="btn btn-secondary custom-player-btn">è‡ªå®šä¹‰æ’­æ”¾å™¨</button>
                </div>
                <div id="player-status" class="player-status"></div>
            </div>
            <div class="setting-description">
                é€‰æ‹©ç”¨äºæ’­æ”¾è§†é¢‘çš„é»˜è®¤æ’­æ”¾å™¨ã€‚å¦‚æœæœªé€‰æ‹©ï¼Œå°†ä½¿ç”¨ç³»ç»Ÿé»˜è®¤æ’­æ”¾å™¨ã€‚
                ç‚¹å‡»"è‡ªå®šä¹‰æ’­æ”¾å™¨"æŒ‰é’®å¯ä»¥é€‰æ‹©æœªæ£€æµ‹åˆ°çš„æ’­æ”¾å™¨ç¨‹åºã€‚
            </div>
        </div>
            </div>
            <div class="modal-actions">
                <button id="save-settings-btn" class="btn btn-primary">ä¿å­˜</button>
                <button id="cancel-settings-btn" class="btn btn-secondary">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        console.log('ğŸ”¥ å†…è”è„šæœ¬æ‰§è¡ŒæˆåŠŸï¼');
        console.log('ğŸ”¥ æµ‹è¯•ï¼šHTMLåŠ è½½æ­£å¸¸');

        // å†…è”è®¾ç½®æ¨¡æ€æ¡†åŠŸèƒ½
        function openSettingsModalInline() {
            console.log('ğŸ”§ å¼€å§‹æ‰“å¼€è®¾ç½®æ¨¡æ€æ¡†ï¼ˆå†…è”ç‰ˆæœ¬ï¼‰');
            const modal = document.getElementById('settings-modal');
            if (modal) {
                modal.style.display = 'block';
                modal.classList.add('show');
                console.log('âœ… è®¾ç½®æ¨¡æ€æ¡†å·²æ˜¾ç¤º');

                // æ·»åŠ å…³é—­äº‹ä»¶ç›‘å¬å™¨
                const closeBtn = document.getElementById('cancel-settings-btn');
                const saveBtn = document.getElementById('save-settings-btn');

                // ç§»é™¤æ—§çš„ç›‘å¬å™¨ä»¥é¿å…é‡å¤ç»‘å®š
                const newCloseBtn = closeBtn.cloneNode(true);
                const newSaveBtn = saveBtn.cloneNode(true);
                closeBtn.parentNode.replaceChild(newCloseBtn, closeBtn);
                saveBtn.parentNode.replaceChild(newSaveBtn, saveBtn);

                // å…³é—­æŒ‰é’®
                newCloseBtn.addEventListener('click', function() {
                    console.log('âŒ å…³é—­è®¾ç½®æ¨¡æ€æ¡†');
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                });

                // ä¿å­˜æŒ‰é’®
                newSaveBtn.addEventListener('click', function() {
                    console.log('ğŸ’¾ ä¿å­˜è®¾ç½®ï¼ˆå†…è”ç‰ˆæœ¬ï¼‰');
                    alert('è®¾ç½®ä¿å­˜åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...');
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                });

                // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                        modal.classList.remove('show');
                    }
                });
            } else {
                console.error('âŒ æœªæ‰¾åˆ°è®¾ç½®æ¨¡æ€æ¡†å…ƒç´ ');
            }
        }

        // æµ‹è¯•æŒ‰é’®å…ƒç´ æ˜¯å¦å­˜åœ¨
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”¥ DOMäº‹ä»¶è§¦å‘ï¼');
            console.log('ğŸ”¥ è®¾ç½®æŒ‰é’®:', document.getElementById('open-settings-btn'));
            console.log('ğŸ”¥ ä¸»é¢˜åˆ‡æ¢:', document.getElementById('theme-toggle'));

            // ç›´æ¥æ·»åŠ æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼Œä¸ä¾èµ–ä»»ä½•æ¨¡å—
            const settingsBtn = document.getElementById('open-settings-btn');
            const themeToggle = document.getElementById('theme-toggle');

            if (settingsBtn) {
                settingsBtn.addEventListener('click', function() {
                    console.log('âš™ï¸ è®¾ç½®æŒ‰é’®ç‚¹å‡»æˆåŠŸï¼ï¼ˆæ— æ¨¡å—ä¾èµ–ç‰ˆæœ¬ï¼‰');
                    openSettingsModalInline();
                });
            }

            if (themeToggle) {
                themeToggle.addEventListener('change', function() {
                    console.log('ğŸ¨ ä¸»é¢˜åˆ‡æ¢æˆåŠŸï¼ï¼ˆæ— æ¨¡å—ä¾èµ–ç‰ˆæœ¬ï¼‰');
                    const newTheme = themeToggle.checked ? 'dark' : 'light';
                    document.body.setAttribute('data-theme', newTheme);
                    alert(`ä¸»é¢˜åˆ‡æ¢ä¸º${newTheme === 'dark' ? 'æ·±è‰²' : 'æµ…è‰²'}æ¨¡å¼ï¼`);
                });
            }
        });
    </script>
    <script src="src/renderer/renderer.js"></script>
</body>

</html>